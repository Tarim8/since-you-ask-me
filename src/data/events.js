const events = [
  {
    episode: 1,
    scene: 1,
    year: 2020,
    inYearSortIndex: 1,
    location: "Online",
    description: `
      During the [COVID-19 lockdown](#covid-19), [Deborah](@deborah-wilkinson) and [Jerry](@jerry-wilkinson)
      coordinate to virtually pull a [Christmas cracker](#christmas-crackers) on a family video call.
      They are helped in their attempt by [Toby](@toby) and [Alex](@alex), and lightly teased by [Russ](@russ-golding).

      While playing a round of charades, Deborah calls the rest of the family [“spaniels”](#jerrys-aphasia) for deliberately
      avoiding the correct guess, even though she had already revealed the answer accidentally.

      The family each rip up the hat that they get from their cracker, although Alex has to first be reminded to do so.

      Instead of Christmas [pudding](#pudding), Deborah has half a scotch egg.

      At one point during the call, Alex tells Toby to let their [dog](#dogs), Oswald, out.
    `,
  },
  {
    episode: 1,
    scene: 2,
    year: 2018,
    inYearSortIndex: 0,
    location: "Hastings",
    description: `
      In preparation for [Pier Pressure](#pier-pressure) playing at a [funeral](#funerals),
      [Russ](@russ-golding) phones the bereaved to discussed the setlist.

      Russ informs him that they cannot perform <em>Ding-Dong! The Witch is Dead</em> and that they have to stick to the original lyrics for
      <em>Always Look on the Bright Side of Life</em>, but can otherwise accommodate his (largely witch-themed) requests.
    `,
  },
  {
    episode: 1,
    scene: 3,
    year: 2010,
    inYearSortIndex: 0,
    location: "Lanzarote",
    description: `
      On the beach, [Alex](@alex) asks [Russ](@russ-golding) about a little mark on his shoulder.
      Russ tells him that it is a [tattoo](#russ-tattoo) of the lower jawbone of a crocodile.

      He explains that a crocodile has strong muscles for closing its jaw but only weak ones for opening it.
      He claims that the tattoo is to remind him that strength depends on how you measure it.
    `,
  },
  {
    episode: 1,
    scene: 4,
    year: 2006,
    inYearSortIndex: 0,
    location: "Larmer Tree Festival",
    description: `
      [Pier Pressure](#pier-pressure) perform their version of [<em>Woof, Woof, Woof</em>](#woof-woof-woof) at the Larmer Tree Festival.

      The song is introduced as being “from the diseased mind of [the drummer](@russ-golding)” and features various dog impressions.
    `,
  },
  {
    episode: 1,
    scene: 5,
    year: 2004,
    inYearSortIndex: 0,
    location: "Hastings",
    description: `
      In a band meeting, one of the members of [Pier Pressure](#pier-pressure) suggests they do a cover of <em>A Nightingale Sang in Berkeley Square</em>.
      [Russ](@russ-golding) insists that they should do “the famous bit” and gives a short rendition of [<em>Woof, Woof, Woof</em>](#woof-woof-woof).

      After an initial stunned silence, the rest of the band start to laugh at Russ’ insistence that this is how the song goes.
      Their hilarity grows as Russ sings in a high pitched voice and explains that it is the nightingale doing dog impressions.

      The lead singer resolves that they are doing the song.
      He dismisses the rest of the band except for Russ, to whom he says: “You and me are writing a song, [Jawbone](#russ-tattoo).”
    `,
  },
  {
    episode: 1,
    scene: 6,
    year: 2003,
    inYearSortIndex: 0,
    location: "Hastings",
    description: `
      [Russ](@russ-golding) asks a tattoo artist to give him the smallest possible [tattoo](#russ-tattoo) which is still recognisably an animal.
      They decide on a crocodile, because it is thin but distinctive.

      When asked, Russ admits that he is only getting the tattoo because of peer pressure from [his band](#pier-pressure).
      In fact, he tells her, that is literally the name of the band (although they spell it ‘Pier Pressure’ because of Hastings Pier).

      The tattoo artist lets him change this answer so that she is allowed to give him the tattoo, but tells him that she can stop anytime he wants.
    `,
  },
  {
    episode: 1,
    scene: 7,
    year: 2001,
    inYearSortIndex: 0,
    location: "Hastings",
    description: `
      On his way out for the evening, [Russ](@russ-golding) is quibbling with his mum, [Deborah](@deborah-wilkinson),
      about the time he needs to be home. Russ tries to argue for midnight, then 11pm, but Deborah insists on 10pm, after
      invoking the threat of 9pm.

      Then, on his way out the door, Russ  comes out to Deborah with a forced casualness, saying:
      “Not a big deal or anything, but, as it goes, I’m gay.”

      Deborah stops him from leaving so that she can express her support for him. She also insists that she is totally surprised by the news.

      Russ sees through her fake surprise, since his mum specialises in [reading people](#reading-people).
      Deborah admits that she already knew and Russ tells her that he already knew she already knew.

      Russ then attempts to change his curfew to 11pm again, but is told that being gay does not get him an extra hour.
    `,
  },
  {
    episode: 1,
    scene: 8,
    year: 1994,
    inYearSortIndex: 0,
    location: "Dover",
    description: `
      [Russ](@russ-golding) is being harassed by a bully named Craig.
      When Craig hits him, Russ exclaims: “Oi! [Half a glass](#half-a-glass)!”

      Craig then takes Russ’ guitar, but loses interest when Russ refuses to fight him for it, so he returns it.

      Russ, realising he will be late home, asks Craig for 20p to call his parents.
      Although the sum is revised to 10p, Craig does give him money under the instruction that he tells no-one.
    `,
  },
  {
    episode: 1,
    scene: 9,
    year: 1990,
    inYearSortIndex: 0,
    location: "Long Buckby",
    description: `
      At [Vanessa](@vanessa-wilkinson)’s [funeral](#funerals), [Deborah](@deborah-wilkinson) leaves [Russ](@russ-golding)
      in the care of [Uncle Newt](@oswald-newt-nightingale) while she finds her father, [Jerry](@jerry-wilkinson), to prevent him from
      doing a [poem](#poetry).
      Deborah leaves Russ with instructions to be [“Level 5 good”](#good-behaviour).

      Russ learns Newt’s name, which leads to a discussion of amphibians and, in particular, why turtles are not amphibians.
      Newt gives him a brief [scientific explanation](#science) of the difference between reptiles and turtles,
      but Russ does not want to hear more.

      Instead, Russ asks Newt for a [story](#stories) about Teenage Mutant Hero Turtles.
      Having been informed that the turtles names are Michaelangelo, Raphael, Donatello and Leonardo,
      Newt tells Russ a story about turtles in Renaissance Florence.
    `,
  },
  {
    episode: 2,
    scene: 1,
    year: 2020,
    inYearSortIndex: 0,
    location: "Hastings & Hook Norton",
    description: `
      [Russ](@russ-golding) and [Deborah](@deborah-wilkinson) have a Zoom call during the [COVID-19 pandemic](#covid-19).

      They both admit that they are secretly enjoying the lockdown.
      Deborah enjoys the community spirit and her increased communication with people via Zoom.
      Conversely, Russ is glad to have the excuse not to socialise with others, but instead spend more time with his family.

      Despite this, they make each other promise to keep up the pretence that they are both having a terrible time.
    `,
  },
  {
    episode: 2,
    scene: 2,
    year: 2012,
    inYearSortIndex: 0,
    location: "Banbury",
    description: `
      [Deborah](@deborah-wilkinson) arrives late to give a fencing lesson.
      She easily fends off her student while giving him instructions,
      despite the fact that she hasn’t yet had time to change out of her heels.

      During the lesson, she deduces that her student’s partner is away at the moment.
      This comes from [her observation](#reading-people) that he has his phone in his shirt pocket, which is what he does when his mother is babysitting.
    `,
  },
  {
    episode: 2,
    scene: 3,
    year: 1997,
    inYearSortIndex: 0,
    location: "Reading",
    description: `
      [Deborah](@deborah-wilkinson) is visting her father, [Jerry](@jerry-wilkinson), who is suffering from [aphasia](#jerrys-aphasia).
      Deborah is supportive in helping him to communicate, but can’t quite suppress a giggle when he says “backwards and forwards”
      instead of his usual [“onwards and upwards”](#jerrys-sayings).

      The two are attempting to play Scrabble. However, after Jerry plays <span class="monospace">HVRAST</span> (which he pronounces “hockets”),
      Deborah is able to convince him that he is not yet recovered enough for the game.

      After Jerry is able to sing the first line of <em>We Plough the Fields and Scatter</em>,
      Deborah realises that the word he was trying to play was <span class="monospace">HARVEST</span>.
    `,
  },
  {
    episode: 2,
    scene: 4,
    year: 1994,
    inYearSortIndex: 1,
    location: "Hastings",
    description: `
      While working as a travel agent, [Deborah](@deborah-wilkinson) uses her talent for [understanding people](#reading-people)
      to suggest that a couple book a holiday in Jersey.
      The destination perfectly matches their opposing needs, such as liking France but not French food.

      She tells them that one option for travelling there would be to go by [ferry](#boats).
      She describes it as a “proper ferry … not a silly one like the Isle of Wight”.
    `,
  },
  {
    episode: 2,
    scene: 5,
    year: 1984,
    inYearSortIndex: 0,
    location: "Dover",
    description: `
      [Deborah](@deborah-wilkinson) sings [<em>Woof, Woof, Woof</em>](#woof-woof-woof) in the form of a lullaby
      to an infant [Russ](@russ-golding).
    `,
  },
  {
    episode: 2,
    scene: 6,
    year: 1980,
    inYearSortIndex: 0,
    location: "Dover",
    description: `
      [Deborah](@deborah-wilkinson) is filling out a passport application for her husband, [Cliff](@cliff-golding),
      in preparation for a holiday.

      Cliff has never been abroad. Even though he works on a [ferry](#boats) and goes to France four times a day, he has never disembarked from the boat.

      The two bicker about Cliff’s unhelpful answers and about what counts as a ‘distinguishing mark’.
    `,
  },
  {
    episode: 2,
    scene: 7,
    year: 1976,
    inYearSortIndex: 0,
    location: "Reading",
    description: `
      [Deborah](@deborah-wilkinson) tells her parents, [Jerry](@jerry-wilkinson) and [Hilla](@hilla-wilkinson), that she got engaged during a trip away.
      Her father is delighted at the news, but her mother is more sceptical.

      Deborah explains that she met her fiancé on a [ferry crossing](#boats) to France.
      He was working onboard and looked after her during a storm.

      Jerry is amused to discover that the man comes from Dover and is named [Cliff](@cliff-golding).
    `,
  },
  {
    episode: 2,
    scene: 8,
    year: 1972,
    inYearSortIndex: 0,
    location: "Bradford-on-Avon",
    description: `
      [Deborah](@deborah-wilkinson) and her grandmother, [Vanessa](@vanessa-wilkinson), are [people watching](#reading-people).
      They speculate on the lives of passers-by, whom they variously nickname Big Coat, Sideburns, Earrings and Orange Shirt.

      Although impressed with her grandmother’s skill, Deborah laments that the conclusions are never something more exciting,
      like the subjects being Russian spies.
    `,
  },
  {
    episode: 2,
    scene: 9,
    year: 1967,
    inYearSortIndex: 0,
    location: "Lemington Spa",
    description: `
      The Wilkinson famliy – [Jerry](@jerry-wilkinson), [Hilla](@hilla-wilkinson), [Myra](@myra-wilkinson),
      [Deborah](@deborah-wilkinson) and [Benji](@benji-wilkinson) – are meeting Jerry’s parents for dinner.

      Upon arriving at the restaurant, Jerry realises that it is a posher venue than they were expecting.
      He reluctantly enforces [“Gale Force 5 table manners”](#good-behaviour) on the children.

      As compensation, Jerry promises that they will keep the meal to a short two courses and declares open season on the pudding menu.
      Since Deborah doesn’t like [pudding](#pudding), she is offered the option to have a starter for pudding instead.

      Jerry counts them all down to the start of the enforcement of manners.
      During the five second countdown, the family make wild and rude noises.
      They stop immediately when he reaches zero and all commence best behaviour.
    `,
  },
  {
    episode: 2,
    scene: 10,
    year: 1962,
    inYearSortIndex: 0,
    location: "Reading",
    description: `
      [Uncle Newt](@oswald-newt-nightingale) is babysitting [Myra](@myra-wilkinson) and [Deborah](@deborah-wilkinson).
      As he is putting them to bed, they plead with him to tell them a bedtime [story](#stories).

      Deborah wants a story about ghosts, while Myra wants a story about gardens.
      Uncle Newt compromises by telling them a story about a haunted garden.
    `,
  },

  // Referenced events that are not the subject of sketches,
  // but do provide dates for births or deaths.
  {
    episode: 0,
    scene: 1,
    year: 1951,
    inYearSortIndex: 0,
    location: "",
    description: "Cliff’s birth",
  },
];

module.exports = events.map((event) => {
  event.characters = event.characters || [];
  event.themes = event.themes || [];
  const matches = event.description.matchAll(/\[[^\]]+\]\(([@#][0-9a-z-]+)\)/g);
  for (const match of matches) {
    const tag = match[1];
    const type = tag[0];
    const id = tag.substring(1);
    if (type === "@") {
      event.characters.push(id);
    } else if (type === "#") {
      event.themes.push(id);
    }
  }
  return event;
});
